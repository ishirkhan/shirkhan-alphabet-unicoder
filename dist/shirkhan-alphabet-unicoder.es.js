const table = [
  {
    uchar: "\u0626",
    basic: 1574,
    extend: {
      single: 65163,
      first: 65163,
      middle: 65164,
      last: 65164,
      absent: true
    }
  },
  {
    uchar: "\u0627",
    basic: 1575,
    extend: {
      single: 65165,
      first: 65165,
      middle: 65166,
      last: 65166,
      absent: false
    }
  },
  {
    uchar: "\u06D5",
    basic: 1749,
    extend: {
      single: 65257,
      first: 65257,
      middle: 65258,
      last: 65258,
      absent: false
    }
  },
  {
    uchar: "\u0628",
    basic: 1576,
    extend: {
      single: 65167,
      first: 65169,
      middle: 65170,
      last: 65168,
      absent: true
    }
  },
  {
    uchar: "\u067E",
    basic: 1662,
    extend: {
      single: 64342,
      first: 64344,
      middle: 64345,
      last: 64343,
      absent: true
    }
  },
  {
    uchar: "\u062A",
    basic: 1578,
    extend: {
      single: 65173,
      first: 65175,
      middle: 65176,
      last: 65174,
      absent: true
    }
  },
  {
    uchar: "\u062C",
    basic: 1580,
    extend: {
      single: 65181,
      first: 65183,
      middle: 65184,
      last: 65182,
      absent: true
    }
  },
  {
    uchar: "\u0686",
    basic: 1670,
    extend: {
      single: 64378,
      first: 64380,
      middle: 64381,
      last: 64379,
      absent: true
    }
  },
  {
    uchar: "\u062E",
    basic: 1582,
    extend: {
      single: 65189,
      first: 65191,
      middle: 65192,
      last: 65190,
      absent: true
    }
  },
  {
    uchar: "\u062F",
    basic: 1583,
    extend: {
      single: 65193,
      first: 65193,
      middle: 65194,
      last: 65194,
      absent: false
    }
  },
  {
    uchar: "\u0631",
    basic: 1585,
    extend: {
      single: 65197,
      first: 65197,
      middle: 65198,
      last: 65198,
      absent: false
    }
  },
  {
    uchar: "\u0632",
    basic: 1586,
    extend: {
      single: 65199,
      first: 65199,
      middle: 65200,
      last: 65200,
      absent: false
    }
  },
  {
    uchar: "\u0698",
    basic: 1688,
    extend: {
      single: 64394,
      first: 64394,
      middle: 64395,
      last: 64395,
      absent: false
    }
  },
  {
    uchar: "\u0633",
    basic: 1587,
    extend: {
      single: 65201,
      first: 65203,
      middle: 65204,
      last: 65202,
      absent: true
    }
  },
  {
    uchar: "\u0634",
    basic: 1588,
    extend: {
      single: 65205,
      first: 65207,
      middle: 65208,
      last: 65206,
      absent: true
    }
  },
  {
    uchar: "\u063A",
    basic: 1594,
    extend: {
      single: 65229,
      first: 65231,
      middle: 65232,
      last: 65230,
      absent: true
    }
  },
  {
    uchar: "\u0641",
    basic: 1601,
    extend: {
      single: 65233,
      first: 65235,
      middle: 65236,
      last: 65234,
      absent: true
    }
  },
  {
    uchar: "\u0642",
    basic: 1602,
    extend: {
      single: 65237,
      first: 65239,
      middle: 65240,
      last: 65238,
      absent: true
    }
  },
  {
    uchar: "\u0643",
    basic: 1603,
    extend: {
      single: 65241,
      first: 65243,
      middle: 65244,
      last: 65242,
      absent: true
    }
  },
  {
    uchar: "\u06AF",
    basic: 1711,
    extend: {
      single: 64402,
      first: 64404,
      middle: 64405,
      last: 64403,
      absent: true
    }
  },
  {
    uchar: "\u06AD",
    basic: 1709,
    extend: {
      single: 64467,
      first: 64469,
      middle: 64470,
      last: 64468,
      absent: true
    }
  },
  {
    uchar: "\u0644",
    basic: 1604,
    extend: {
      single: 65245,
      first: 65247,
      middle: 65248,
      last: 65246,
      absent: true
    }
  },
  {
    uchar: "\u0645",
    basic: 1605,
    extend: {
      single: 65249,
      first: 65251,
      middle: 65252,
      last: 65250,
      absent: true
    }
  },
  {
    uchar: "\u0646",
    basic: 1606,
    extend: {
      single: 65253,
      first: 65255,
      middle: 65256,
      last: 65254,
      absent: true
    }
  },
  {
    uchar: "\u06BE",
    basic: 1726,
    extend: {
      single: 64426,
      first: 64428,
      middle: 64429,
      last: 64427,
      absent: true
    }
  },
  {
    uchar: "\u0648",
    basic: 1608,
    extend: {
      single: 65261,
      first: 65261,
      middle: 65262,
      last: 65262,
      absent: false
    }
  },
  {
    uchar: "\u06C7",
    basic: 1735,
    extend: {
      single: 64471,
      first: 64471,
      middle: 64472,
      last: 64472,
      absent: false
    }
  },
  {
    uchar: "\u06C6",
    basic: 1734,
    extend: {
      single: 64473,
      first: 64473,
      middle: 64474,
      last: 64474,
      absent: false
    }
  },
  {
    uchar: "\u06C8",
    basic: 1736,
    extend: {
      single: 64475,
      first: 64475,
      middle: 64476,
      last: 64476,
      absent: false
    }
  },
  {
    uchar: "\u06CB",
    basic: 1739,
    extend: {
      single: 64478,
      first: 64478,
      middle: 64479,
      last: 64479,
      absent: false
    }
  },
  {
    uchar: "\u06D0",
    basic: 1744,
    extend: {
      single: 64484,
      first: 64486,
      middle: 64487,
      last: 64485,
      absent: true
    }
  },
  {
    uchar: "\u0649",
    basic: 1609,
    extend: {
      single: 65263,
      first: 64488,
      middle: 64489,
      last: 65264,
      absent: true
    }
  },
  {
    uchar: "\u064A",
    basic: 1610,
    extend: {
      single: 65265,
      first: 65267,
      middle: 65268,
      last: 65266,
      absent: true
    }
  }
];
function repalceLa(str) {
  return str.replace(/(\uFEDF\uFE8E)/g, function() {
    return String.fromCharCode(65275);
  }).replace(/(\uFEE0\uFE8E)/g, function() {
    return String.fromCharCode(65276);
  });
}
function reverseStr(str) {
  return str.split("").reverse().join("");
}
function str2rtl(str) {
  return reverseStr(str).replace(/([^\uFB00-\uFEFF\u0600-\u06FF\s]+)/g, function(word) {
    return reverseStr(word);
  });
}
function firstChar(currentItem) {
  return String.fromCharCode(currentItem.extend.first);
}
function middleChar(currentItem, preItem) {
  if (!preItem)
    return "";
  let result = "";
  if (preItem.extend.absent) {
    result += String.fromCharCode(currentItem.extend.middle);
  } else {
    result += String.fromCharCode(currentItem.extend.first);
  }
  return result;
}
function lastChar(currentItem, preItem) {
  if (!preItem)
    return "";
  let result = "";
  if (preItem.extend.absent) {
    result += String.fromCharCode(currentItem.extend.last);
  } else {
    result += String.fromCharCode(currentItem.extend.single);
  }
  return result;
}
function word2extend(word) {
  const alphaMap = {};
  table.forEach((item) => alphaMap[item.uchar] = item);
  let result = "";
  const chars = word.trim().split("");
  chars.reduce((pre, cur, index, data) => {
    const preItem = alphaMap[pre];
    const currentItem = alphaMap[cur];
    if (data.length === 1) {
      result += String.fromCharCode(currentItem.extend.single);
      return cur;
    }
    if (data.length > 1 && index === 0) {
      result += firstChar(currentItem);
      return cur;
    }
    if (data.length - 1 === index) {
      result += lastChar(currentItem, preItem);
      return cur;
    }
    result += middleChar(currentItem, preItem);
    return cur;
  }, chars[0]);
  return result;
}
function _basic2extend(str) {
  return str.replace(/[\u0626-\u06d5]+/g, (word) => word2extend(word));
}
function basic2extend(str) {
  return str2rtl(repalceLa(_basic2extend(str)));
}
export { basic2extend };
